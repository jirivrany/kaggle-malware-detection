# coding: utf-8
import pandas as pd 
from utils import reduce_mem_usage, DTYPES
import gc

if __name__ == '__main__':


    version_cols = ['EngineVersion', 'AppVersion', 'AvSigVersion', 'MachineIdentifier']

    use_cols = [col for col in DTYPES.keys() if col not in version_cols]

    train = pd.read_csv('../input/train.csv',
                        usecols=use_cols,
                        dtype = DTYPES)




    train = reduce_mem_usage(train)

    train.to_pickle('../input/train_no_versions.pkl')
    print("TRAIN SAVED to PICKLE")

    del(train)
    gc.collect()

    use_cols.remove('HasDetections')

    test = pd.read_csv('../input/test.csv',
                       usecols=use_cols, 
                       dtype = DTYPES)

    test = reduce_mem_usage(test)

    test.to_pickle('../input/test_no_versions.pkl')
    print("TEST SAVED to PICKLE")