from os import path
import pandas as pd
import kaggle

df1_fname = 'rstarter-v2-corrfeat2.csv.gz'
df2_fname = 'submit_e57_cv074605.csv.gz'
df3_fname = 'sparse_matrices_kernel_sub.csv.gz'
df4_fname = 'submit_e67_cv074536.csv.gz'

blend_name = 'blend_v8.csv.gz'
output_dir =  '../output/'

df1 = pd.read_csv(path.join(output_dir, df1_fname), compression='gzip')
df2 = pd.read_csv(path.join(output_dir, df2_fname), compression='gzip')
df3 = pd.read_csv(path.join(output_dir, df3_fname), compression='gzip')
df4 = pd.read_csv(path.join(output_dir, df4_fname), compression='gzip')

bof = df1['HasDetections'] * 0.25 + df2['HasDetections'] * 0.25 + df3['HasDetections'] * 0.25 + df4['HasDetections'] * 0.25
sample = pd.read_csv('../input/sample_submission.csv')

sample['HasDetections'] = bof
sample.to_csv(path.join(output_dir, blend_name), compression='gzip', index=False)

message = 'Blend {} of {} + {} + {} + {}'.format(blend_name, df1_fname, df2_fname, df3_fname, df4_fname)
competition = 'microsoft-malware-prediction'
kaggle.api.competition_submit(path.abspath(path.join(output_dir, blend_name)), message, competition)