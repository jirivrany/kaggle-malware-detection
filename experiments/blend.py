from os import path
import pandas as pd
import kaggle

df1_fname = 'rstarter-v2-corrfeat2.csv.gz'
df2_fname = 'submit_e54_cv074281.csv.gz'
blend_name = 'blend_v6.csv.gz'
output_dir =  '../output/'

df1 = pd.read_csv(path.join(output_dir, df1_fname), compression='gzip')
df2 = pd.read_csv(path.join(output_dir, df2_fname), compression='gzip')

double_blend = df1['HasDetections'] * 0.5 + df2['HasDetections'] * 0.5
sample = pd.read_csv('../input/sample_submission.csv')

sample['HasDetections'] = double_blend
sample.to_csv(path.join(output_dir, blend_name), compression='gzip', index=False)

message = 'Blend {} of {} and {}'.format(blend_name, df1_fname, df2_fname)
competition = 'microsoft-malware-prediction'
kaggle.api.competition_submit(path.abspath(path.join(output_dir, blend_name)), message, competition)